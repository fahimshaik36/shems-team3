<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>SHEMS – Policy Enforcement Logs</title>

<style>
:root{
  --bg:#f5f7fb;
  --card:#ffffff;
  --text:#1f2937;
  --muted:#6b7280;
  --primary:#2563eb;
  --danger:#dc2626;
  --success:#16a34a;
  --sidebar:#0f172a;
}

body.dark{
  --bg:#0b1220;
  --card:#111827;
  --text:#f8fafc;
  --muted:#9ca3af;
  --primary:#3b82f6;
}

body{
  margin:0;
  font-family:Segoe UI, sans-serif;
  background:var(--bg);
  color:var(--text);
  transition:.3s;
}

/* Sidebar */
.sidebar{
 width:220px;
 height:100vh;
 background:var(--sidebar);
 color:white;
 position:fixed;
 padding-top:30px;
}
.sidebar h2{
 text-align:center;
 margin-bottom:30px;
 letter-spacing:1px;
}
.sidebar a{
 display:block;
 color:#cbd5e1;
 padding:12px 25px;
 text-decoration:none;
 font-size:15px;
}
.sidebar a:hover,
.sidebar a.active{
 background:#1e293b;
 color:white;
}

/* Header */
.header{
 margin-left:220px;
 background:var(--primary);
 color:white;
 padding:20px 30px;
 display:flex;
 justify-content:space-between;
 align-items:center;
}
.header h1{
 margin:0;
 font-size:22px;
}

/* Theme Switch */
.theme-switch{
 width:46px;
 height:24px;
 background:#bfdbfe;
 border-radius:20px;
 position:relative;
 cursor:pointer;
}
.theme-switch::before{
 content:"";
 position:absolute;
 width:18px;
 height:18px;
 background:white;
 border-radius:50%;
 top:3px;
 left:3px;
 transition:.3s;
}
body.dark .theme-switch{background:#60a5fa;}
body.dark .theme-switch::before{transform:translateX(22px);}

/* Main */
.main{
 margin-left:220px;
 padding:30px;
}

/* Cards */
.card{
 background:var(--card);
 padding:22px;
 border-radius:12px;
 box-shadow:0 4px 12px rgba(0,0,0,.08);
 margin-bottom:25px;
}

/* Table */
table{
 width:100%;
 border-collapse:collapse;
 background:var(--card);
 border-radius:12px;
 overflow:hidden;
 box-shadow:0 4px 12px rgba(0,0,0,.08);
}
th,td{
 padding:14px 16px;
 text-align:left;
}
th{
 background:#e0e7ff;
 color:#1e3a8a;
 font-size:14px;
}
tr:nth-child(even){
 background:rgba(0,0,0,0.02);
}

/* Badges */
.badge-off{
 background:#fee2e2;
 color:#991b1b;
 padding:5px 12px;
 border-radius:20px;
 font-size:12px;
 font-weight:700;
}
</style>

<script>
function toggleTheme(){
  document.body.classList.toggle("dark");
  localStorage.setItem(
    "theme",
    document.body.classList.contains("dark") ? "dark":"light"
  );
}
window.onload=function(){
  if(localStorage.getItem("theme")==="dark"){
    document.body.classList.add("dark");
  }
};
</script>
</head>

<body>

<!-- Sidebar -->
<div class="sidebar">
 <h2>SHEMS</h2>
 <a href="/admin">Home</a>
 <a href="/adminScreen">Dashboard</a>
 <a href="/adminScreen/devices">Devices</a>
 <a href="/admin/analytics">Analytics</a>
 <a href="/admin/policies">Energy Policies</a>
 <a href="/admin/policies/logs" class="active">Policy Logs</a>
 <a href="/logout">Logout</a>
</div>

<!-- Header -->
<div class="header">
 <h1>Admin – Policy Enforcement Logs</h1>
 <div style="display:flex;align-items:center;gap:15px;">
   <div>System Audit Trail</div>
   <div class="theme-switch" onclick="toggleTheme()"></div>
 </div>
</div>

<!-- Main -->
<div class="main">

 <div class="card">
  <h3>Recent Policy Enforcement Actions</h3>

  <table>
   <tr>
    <th>Policy</th>
    <th>Device</th>
    <th>User</th>
    <th>Energy Used</th>
    <th>Threshold</th>
    <th>Action</th>
    <th>Enforced At</th>
   </tr>

   <tr th:each="log : ${logs}">
    <td th:text="${log.policyName}"></td>
    <td th:text="${log.deviceName}"></td>
    <td th:text="${log.userName}"></td>
    <td th:text="${#numbers.formatDecimal(log.energyConsumed,1,3)} + ' kWh'"></td>
    <td th:text="${log.threshold} + ' kWh'"></td>
    <td><span class="badge-off">FORCED OFF</span></td>
    <td th:text="${#temporals.format(log.enforcedAt,'dd MMM yyyy HH:mm')}"></td>
   </tr>
  </table>
 </div>

</div>

</body>
</html>
